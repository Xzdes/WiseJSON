<p align="center">
  <img src="./logo.png" alt="WiseJSON Logo" width="150"/>
</p>

<h1 align="center">WiseJSON</h1>
<p align="center">
  <a href="https://github.com/Xzdes/WiseJSON">GitHub</a> ‚Ä¢ <a href="https://www.npmjs.com/package/wise-json-db">NPM</a>
</p>
<p align="center">
  –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–µ–≥–º–µ–Ω—Ç–Ω–∞—è JSON-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Node.js ‚Äî –º–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (<b>uuid</b>), –º–∞–∫—Å–∏–º—É–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.
</p>

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîí **–ñ—É—Ä–Ω–∞–ª WAL** + <b>fsync</b> ‚Äî –ø–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- üì¶ **–°–µ–≥–º–µ–Ω—Ç–Ω—ã–µ —á–µ–∫–ø–æ–∏–Ω—Ç—ã** ‚Äî –±—ã—Å—Ç—Ä—ã–π –±—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- üí° **–ò–Ω–¥–µ–∫—Å—ã –≤ –ø–∞–º—è—Ç–∏** (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—è)
- ‚ö° **–ú–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî —Ç–æ–ª—å–∫–æ [uuid](https://www.npmjs.com/package/uuid)
- üìÅ **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è** ‚Äî –Ω–µ –Ω—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä, —Ç–æ–ª—å–∫–æ –ø–∞–ø–∫–∞ —Å —Ñ–∞–π–ª–∞–º–∏
- üîÑ **–ü–∞–∫–µ—Ç–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞, —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç, CLI**
- üß™ **–°—Ç—Ä–µ—Å—Å- –∏ crash-—Ç–µ—Å—Ç—ã** ‚Äî —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º
- ü™ù **–°–æ–±—ã—Ç–∏—è –∏ —Ö—É–∫–∏** ‚Äî before/after –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- üßÆ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –ø–æ –∫–∞–∂–¥–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- üß∞ **–†–∞–±–æ—Ç–∞–µ—Ç —Å pkg/vercel/pkg** ‚Äî —É–¥–æ–±–Ω–æ –≤ CLI –∏ desktop-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
- üöÄ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–µ** ‚Äî CLI, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –±–æ—Ç—ã, –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

- [uuid](https://www.npmjs.com/package/uuid) (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö id)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
npm install wise-json-db
```

```js
const WiseJSON = require('wise-json-db');
const db = new WiseJSON('./my-db');

(async () => {
  const users = await db.collection('users');
  await users.createIndex('email', { unique: true });

  const user = await users.insert({ name: '–ê–ª–∏—Å–∞', email: 'alice@example.com' });
  console.log('ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', user._id);

  const found = await users.findOneByIndexedValue('email', 'alice@example.com');
  console.log('–ù–∞–π–¥–µ–Ω–æ:', found);

  await db.close();
})();
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

```
my-db/
‚îî‚îÄ‚îÄ users/
    ‚îú‚îÄ‚îÄ _checkpoints/
    ‚îÇ   ‚îú‚îÄ‚îÄ checkpoint_meta_users_*.json
    ‚îÇ   ‚îî‚îÄ‚îÄ checkpoint_data_users_*_segN.json
    ‚îî‚îÄ‚îÄ users.wal.jsonl
```

- **WAL** ‚Äî –±—ã—Å—Ç—Ä—ã–π –ª–æ–≥ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ß–µ–∫–ø–æ–∏–Ω—Ç—ã** ‚Äî –Ω–∞–¥—ë–∂–Ω—ã–µ, —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã

---

## üìò API –∫–æ–ª–ª–µ–∫—Ü–∏–∏

| –ú–µ—Ç–æ–¥                                | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
|-------------------------------------- |--------------------------------------------|
| `insert(doc)`                        | –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç                          |
| `insertMany([docs])`                 | –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ                   |
| `update(id, updates)`                | –û–±–Ω–æ–≤–∏—Ç—å –ø–æ ID                             |
| `remove(id)`                         | –£–¥–∞–ª–∏—Ç—å –ø–æ ID                              |
| `getById(id)`                        | –ü–æ–ª—É—á–∏—Ç—å –ø–æ ID                             |
| `getAll()`                           | –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã                              |
| `count()`                            | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ                                 |
| `clear()`                            | –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é                         |
| `createIndex(field, {unique})`       | –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ (—Å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å—é)       |
| `findOneByIndexedValue(field, value)` | –ü–æ–∏—Å–∫ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É               |
| `findByIndexedValue(field, value)`    | –ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É              |
| `find(filter)`                       | –ü–æ–∏—Å–∫ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É (–æ–±—ä–µ–∫—Ç –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è)      |
| `stats()`                            | –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É                        |
| `flushToDisk()`                      | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ–∫–ø–æ–∏–Ω—Ç                         |
| `close()`                            | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å                        |
| `on(event, listener)`                | –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è                            |

---

## ü™ù –°–æ–±—ã—Ç–∏—è –∏ —Ö—É–∫–∏

–î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ª—é–±–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è:

```js
users.on('beforeInsert', doc => {
  doc.createdAt = new Date().toISOString();
});
users.on('afterInsert', doc => {
  console.log('–î–æ–∫—É–º–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω:', doc._id);
});
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:  
- `beforeInsert`, `afterInsert`, `beforeUpdate`, `afterUpdate`, `beforeRemove`, `afterRemove`, `beforeClear`, `afterClear`

---

## üîé –ò–Ω–¥–µ–∫—Å—ã

```js
await users.createIndex('email', { unique: true });
await users.insert({ name: '–ê–ª–∏—Å–∞', email: 'alice@example.com' });
await users.insert({ name: '–ë–æ–±', email: 'alice@example.com' }); // –û—à–∏–±–∫–∞!
```

---

## ‚öô –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –û–ø—Ü–∏—è                             | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
|-----------------------------------|--------------|-------------------------------------------|
| `walForceSync`                    | `true`       | fsync –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏                      |
| `checkpointIntervalMs`            | `300000`     | –ê–≤—Ç–æ—á–µ–∫–ø–æ–∏–Ω—Ç —Ä–∞–∑ –≤ N –º—Å (0=–≤—ã–∫–ª)          |
| `maxWalEntriesBeforeCheckpoint`   | `1000`       | –ß–µ–∫–ø–æ–∏–Ω—Ç –ø–æ—Å–ª–µ N –æ–ø–µ—Ä–∞—Ü–∏–π                 |
| `maxSegmentSizeBytes`             | `1048576`    | –†–∞–∑–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞ (–±–∞–π—Ç)                    |
| `checkpointsToKeep`               | `2`          | –•—Ä–∞–Ω–∏—Ç—å –ø–æ–∫–æ–ª–µ–Ω–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤              |

---

## üíª CLI-–ø—Ä–∏–º–µ—Ä—ã

CLI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç, –ø–æ–∏—Å–∫, –æ—á–∏—Å—Ç–∫—É, –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –¥—Ä.

```bash
node wise-json/cli/wise-json-cli.js insert users name=–ê–ª–∏—Å–∞ email=alice@example.com
node wise-json/cli/wise-json-cli.js export users > users.json
node wise-json/cli/wise-json-cli.js import users < users.json
node wise-json/cli/wise-json-cli.js find users email alice@example.com
node wise-json/cli/wise-json-cli.js clear users
```

---

## üîÑ –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É `my-db/` (—Å–æ –≤—Å–µ–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏, WAL –∏ —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏)
- –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–æ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
node test/extreme-test-wise-json.js
node test/segment-check-test.js
```

---

## üõ°Ô∏è –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

- –ù–∞–¥—ë–∂–Ω—ã–π WAL + –∑–∞–ø–∏—Å—å —á–µ–∫–ø–æ–∏–Ω—Ç–∞ —á–µ—Ä–µ–∑ tmp + rename
- –í—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤–∞—Ä–∏–π–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ/—Å–±–æ–∏ –ø–∏—Ç–∞–Ω–∏—è
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç, –ø–æ—Ç–æ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ WAL

---

## üõ†Ô∏è –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

- **JSON only** ‚Äî –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è**: `WISEJSON_DB_PATH` ‚Äî –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
- **–õ—ë–≥–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** ‚Äî –ø–æ–¥–∫–ª—é—á–∞–π—Ç–µ —Å–≤–æ–∏ —Ö—É–∫–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

---

## ‚ùì FAQ

**Q: –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É?**  
A: –î–∞! –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ CLI, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –±–æ—Ç–∞—Ö, –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.

**Q: –ú–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å —Å–≤–æ–π _id?**  
A: –î–∞, –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ uuid –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

**Q: –ö–∞–∫ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é?**  
A: –ú–µ—Ç–æ–¥ `clear()` –∏–ª–∏ —á–µ—Ä–µ–∑ CLI.

**Q: –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª—ã/–±–∏–Ω–∞—Ä–Ω–∏–∫–∏?**  
A: –ù–µ –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ base64.

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–°–º. —Ñ–∞–π–ª LICENSE.